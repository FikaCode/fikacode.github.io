{"posts":[{"title":"excel强制启用VBA","content":"事实上VBA的启用依赖于运行的容器，VBA本身没有强制启用的功能。但是我们可以用另外一种方法来实现强制启用的功能：如果不启用那么，显示一个页面，提示启用；如果启用就隐藏提示，显示正文。大概代码如下：PrivateSubWorkbook_BeforeClose(CancelAsBoolean)DimshAsWorksheetForEachshtInWorksheetsIfsht.Name&lt;&gt;”Welcome”ThenSheets(sht.Name).Visible=FalseEndIfNextSheets(“Welcome”).Visible=TrueSheets(“Welcome”).SelectThisWorkbook.SaveEndSubPrivateSubWorkbook_Open()DimshtAsWorksheetForEachshtInWorksheetsIfsht.Name&lt;&gt;”Welcome”Thensht.Visible=xlSheetVisibleEndIfNextWorksheets(“Welcome”).Visible=xlSheetVeryHiddenThisWorkbook.SaveEndSub代码很好理解：关闭之前，隐藏所有sheet，只显示Welcome；打开文件隐藏Welcome，显示正文。","link":"https://fikacode.github.io/post/excelForceEnableVba/"},{"title":"spring boot 打包为外置 tomcat (war)","content":"修改pom文件&lt;packaging&gt;war&lt;/packaging&gt;&lt;dependency&gt;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;!--移除嵌入式tomcat插件--&gt;&lt;exclusions&gt;&lt;exclusion&gt;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;&lt;/exclusion&gt;&lt;/exclusions&gt;&lt;/dependency&gt;&lt;dependency&gt;&lt;groupId&gt;javax.servlet&lt;/groupId&gt;&lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;&lt;version&gt;4.0.1&lt;/version&gt;&lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt;修改Application启动类修改前publicclassApplication{publicstaticvoidmain(String[]args){SpringApplication.run(Application.class,args);}}修改后publicclassApplicationextendsSpringBootServletInitializer{@OverrideprotectedSpringApplicationBuilderconfigure(SpringApplicationBuilderbuilder){returnbuilder.sources(Application.class);}publicstaticvoidmain(String[]args){SpringApplication.run(Application.class,args);}}特别注意如果使用了websocket，那么需要注释掉下面的代码，同时添加websocket的支持。@ConfigurationpublicclassWebSocketConfig{//@Bean//publicServerEndpointExporterserverEndpointExporter(){//returnnewServerEndpointExporter();//}}&lt;!--https://mvnrepository.com/artifact/javax.websocket/javax.websocket-api--&gt;&lt;dependency&gt;&lt;groupId&gt;javax.websocket&lt;/groupId&gt;&lt;artifactId&gt;javax.websocket-api&lt;/artifactId&gt;&lt;version&gt;1.1&lt;/version&gt;&lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt;如果使用了注解@WebFilter，那么需要使用FilterRegistrationBean的方式来注册Filter。","link":"https://fikacode.github.io/post/springbootPackageToWar/"},{"title":"tomcat 常用的优化","content":"catalina设置java参数setCATALINA_OPTS=-Dfile.encoding=UTF-8-server-Xms8192m-Xmx8192m-Xmn4096m-XX:SurvivorRatio=10-XX:MaxTenuringThreshold=15-XX:NewRatio=2-XX:+DisableExplicitGC根据环境的配置优化相关参数Server.xml设置连接池&lt;Executorname=&quot;tomcatThreadPool&quot;namePrefix=&quot;catalina-exec-&quot;maxThreads=&quot;500&quot;minSpareThreads=&quot;100&quot;prestartminSpareThreads=&quot;true&quot;maxQueueSize=&quot;100&quot;/&gt;开启压缩和NIO2&lt;Connectorexecutor=&quot;tomcatThreadPool&quot;port=&quot;80&quot;protocol=&quot;org.apache.coyote.http11.Http11Nio2Protocol&quot;connectionTimeout=&quot;20000&quot;maxConnections=&quot;10000&quot;redirectPort=&quot;8443&quot;enableLookups=&quot;false&quot;acceptCount=&quot;100&quot;maxPostSize=&quot;10485760&quot;compression=&quot;on&quot;disableUploadTimeout=&quot;true&quot;compressionMinSize=&quot;50&quot;acceptorThreadCount=&quot;4&quot;compressableMimeType=&quot;text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/x-javascript,application/json,image/jpg,application/x-font-ttf,application/x-font-otf,image/svg+xml,image/jpeg,image/png,image/gif,audio/mpeg,video/mp4,font/woff&quot;URIEncoding=&quot;utf-8&quot;/&gt;web.xml设置缓存&lt;filter&gt;&lt;filter-name&gt;ExpiresFilter&lt;/filter-name&gt;&lt;filter-class&gt;org.apache.catalina.filters.ExpiresFilter&lt;/filter-class&gt;&lt;init-param&gt;&lt;param-name&gt;ExpiresByTypeimage&lt;/param-name&gt;&lt;param-value&gt;accessplus30days&lt;/param-value&gt;&lt;/init-param&gt;&lt;init-param&gt;&lt;param-name&gt;ExpiresByTypetext&lt;/param-name&gt;&lt;param-value&gt;accessplus30days&lt;/param-value&gt;&lt;/init-param&gt;&lt;init-param&gt;&lt;param-name&gt;ExpiresByTypeapplication/javascript&lt;/param-name&gt;&lt;param-value&gt;accessplus30days&lt;/param-value&gt;&lt;/init-param&gt;&lt;init-param&gt;&lt;param-name&gt;ExpiresByTypemultipart/form-data&lt;/param-name&gt;&lt;param-value&gt;accessplus30days&lt;/param-value&gt;&lt;/init-param&gt;&lt;init-param&gt;&lt;param-name&gt;ExpiresByTypefont/woff&lt;/param-name&gt;&lt;param-value&gt;accessplus30days&lt;/param-value&gt;&lt;/init-param&gt;&lt;/filter&gt;&lt;filter-mapping&gt;&lt;filter-name&gt;ExpiresFilter&lt;/filter-name&gt;&lt;url-pattern&gt;/*&lt;/url-pattern&gt;&lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;&lt;/filter-mapping&gt;","link":"https://fikacode.github.io/post/tomcatOptimizationAndCache/"},{"title":"java 将数组均分为多个数组","content":"将一组数据平均分成n组/***将一组数据平均分成n组**@paramsource要分组的数据源*@paramn平均分成n组*@param&lt;T&gt;*@return*/publicstatic&lt;T&gt;List&lt;List&lt;T&gt;&gt;averageAssign(List&lt;T&gt;source,intn){List&lt;List&lt;T&gt;&gt;result=newArrayList&lt;List&lt;T&gt;&gt;();intremainder=source.size()%n;//(先计算出余数)intnumber=source.size()/n;//然后是商intoffset=0;//偏移量for(inti=0;i&lt;n;i++){List&lt;T&gt;value=null;if(remainder&gt;0){value=source.subList(i*number+offset,(i+1)*number+offset+1);remainder--;offset++;}else{value=source.subList(i*number+offset,(i+1)*number+offset);}result.add(value);}returnresult;}将一组数据固定分组，每组n个元素/***将一组数据固定分组，每组n个元素*@paramsource要分组的数据源*@paramn每组n个元素*@param&lt;T&gt;*@return*/publicstatic&lt;T&gt;List&lt;List&lt;T&gt;&gt;fixedGrouping(List&lt;T&gt;source,intn){if(null==source||source.size()==0||n&lt;=0)returnnull;List&lt;List&lt;T&gt;&gt;result=newArrayList&lt;List&lt;T&gt;&gt;();intsourceSize=source.size();intsize=(source.size()/n)+1;for(inti=0;i&lt;size;i++){List&lt;T&gt;subset=newArrayList&lt;T&gt;();for(intj=i*n;j&lt;(i+1)*n;j++){if(j&lt;sourceSize){subset.add(source.get(j));}}result.add(subset);}returnresult;}将一组数据固定分组，每组n个元素/***将一组数据固定分组，每组n个元素，第二种写法**@paramsource要分组的数据源*@paramn每组n个元素*@param&lt;T&gt;*@return*/publicstatic&lt;T&gt;List&lt;List&lt;T&gt;&gt;fixedGrouping2(List&lt;T&gt;source,intn){if(null==source||source.size()==0||n&lt;=0)returnnull;List&lt;List&lt;T&gt;&gt;result=newArrayList&lt;List&lt;T&gt;&gt;();intremainder=source.size()%n;intsize=(source.size()/n);for(inti=0;i&lt;size;i++){List&lt;T&gt;subset=null;subset=source.subList(i*n,(i+1)*n);result.add(subset);}if(remainder&gt;0){List&lt;T&gt;subset=null;subset=source.subList(size*n,size*n+remainder);result.add(subset);}returnresult;}","link":"https://fikacode.github.io/post/javaListAverage/"}]}